# HTTP 和浏览器面试题汇总

</br>

### 1、从输入 URL 到页面展示，这中间发生了什么？

参考极客时间...

</br>
</br>

### 2、http 协议简介

**两大特点**

1. 无连接：每次请求结束后，立即与服务端断开 TCP 连接。服务端设置 keep-alive 可建立持续连接

2. 无状态：是指第二次来，你无法识别它曾经来过

**http 构造**

1. http 请求

    - 请求行：请求方法、请求 URI、HTTP 版本协议
    - 请求头：content-type、cookie、User-Agent、connection（keep-alive 重复使用 TCP 连接）
    - 请求体

1. http 响应

    - 响应行：HTTP 协议版本、状态码
    - 响应头：content-type、set-Cookie、Cache-Control、location
    - 响应体

**常见状态码**

1. 1xx：服务器收到请求

2. 2xx：请求成功（例如：200）

3. 3xx：重定向

    - 301：临时重定向
    - 302：永久重定向
    - 304：命中弱缓存

4. 4xx：客户端错误

    - 403：无权限
    - 404：资源不存在

5. 5xx：服务端错误

    - 500：服务错误
    - 504：请求超时

**缺点**

1. 明文传输，未加密

2. 不会验证通讯方的身份，可能会遭遇伪装

3. 不会验证数据的完整性，所以可能会被篡改

</br>
</br>

### 3、https 协议简介

http + ssl/tls 证书 + 数字证书 = https

1. 客户端 ——> 服务端：支持的对称加密算法、支持的非对称加密算法、client 随机数

2. 服务端 ——> 客户端：选择对称加密算法、选择非对称加密算法、server 随机数、证书（服务端信息、公钥）

3. 客户端 ——> 服务端：公钥加密 pre-master 随机数，进行确认

4. 服务端 ——> 客户端：解密出 pre-master 随机数，并确认

5. 双方使用 **对称加密算法（client 随机数 + server 随机数 + pre-master 随机数）** 加密数据内容

</br>
</br>

### 4、UDP、TCP、IP 协议

1. IP：负责把数据包送达目的主机

2. UDP：负责把数据包送达应用程序，通过端口号把数据包分发给正确的程序

    - 不需要建立连接，传输速度很快

    - 数据包在传输过程中容易丢失，不能保证数据可靠性

3. TCP：负责把数据完整地送达应用程序，是一种**面向连接的、可靠的、基于字节流**的传输层通信协议

    - 对于数据包丢失的情况，TCP 提供重传机制

    - 数据包排序机制，用来保证把乱序的数据包组合成一个完整的文件

    - 三次握手、四次挥手

</br>
</br>

### 5、浏览器的多进程架构

**多进程架构**

1. 浏览器进程：即图中的 “浏览器”，主要负责**界面显示、用户交互、子进程管理，同时提供存储等功能**

2. GPU 进程：顾名思义，用于图像的绘制，例如：CSS 的 3D 效果，浏览器最终展示的 UI 界面

3. 渲染进程（多个）：即图中的 “标签页：百度一下,你就知道”，主要用来将 HTML、CSS 和 JavaScript 转换为用户可以与之交互的网页

4. 插件进程（多个）：即图中的 “扩展程序：tampermonkey”，主要负责每个插件的运行

5. 网络进程：即图中的 “Network Service”，主要负责页面的网络资源加载

**单进程架构的问题**

1. 不稳定：任意功能模块的崩溃都会导致浏览器的崩溃。例如：使用的插件崩溃了，整个浏览器也就崩溃了

2. 不流畅：同一时刻，只能运行一个模块，容易阻塞。例如：插件运行死循环，那么整个页面的渲染将会受影响

3. 不安全：恶意插件、页面脚本的威胁

**浏览器上下文组**

</br>
</br>

### 6、Lighthouse 和 Performance 检测页面性能

**Lighthouse**

Performance 面板监测并分析 Web 性能

1. Metrics：：性能指标的评分

    - First Contentful Paint：当页面中绘制了第一个像素时所用的时间，简称 FCP

    - Speed Index：首屏渲染时间

    - Largest Contentful Paint：当首屏内容完全绘制完成时所用的时间，简称 LCP

    - Time to Interactive：表示页面中所有元素都达到了可交互的时长，简称 TTI

    - Total Blocking Time：FCP 到 TTI 之间主线程被阻塞时长的总和，简称 TBT

    - Cumulative Layout Shift：累计布局偏移得分，简单理解：当用户浏览一个页面的时候，若是想要点击一个按钮或者其他交互时，页面的布局突然出然抖动，可能会造成用户的交互行为造成期望之外的结果，简称 CLS

2. opportunities：建议优化项

3. Diagnostics：手动诊断，采集了一些可能存在性能问题的指标，这些指标可能会影响到页面的加载性能

4. Passed audits：优化策略审核，统计了该网站使用了哪些优化策略

</br>

**Performance**

1. 概览面板：宏观查看 FPS、CPU、网络请求、内存使用量的情况

2. 性能分析面板：主要查看并分析 Main 渲染主线程，以梯形的形状去展示，可以看到哪个时间段在执行哪个函数或者哪个任务

3. 详情面板：对选择的时间区见，进行宏观的统计，比如：script 执行时间、rendering 渲染时间、paiting 绘制时间

</br>
</br>

### 7、http1.0 / http1.1 / http2.0 / http3.0

**http1.0**

1. 通过新增请求头和响应头来进行协商

2. 响应行引入了状态码，用来告诉服务端处理的情况

3. 提供了 Cache 机制，用来缓存已经下载过的数据，减轻服务器的压力

4. 需要使用 Connection: keep-alive 才能支持 TCP 复用

**http1.1**

1. 改进持久连接：HTTP/1.1 中增加了持久连接的方法，在一个 TCP 连接上可以传输多个 HTTP 请求，只要浏览器或者服务器没有明确断开连接，那么该 TCP 连接会一直保持，**默认是开启的**

2. 虚拟主机的支持：随着虚拟主机技术的发展，需要实现在一台物理主机上绑定多个虚拟主机，每个虚拟主机都有自己的单独的域名，这些单独的域名都公用同一个 IP 地址。HTTP/1.1 在请求头中增加了 Host 字段，用来表示当前的域名地址，这样服务器就可以根据不同的 Host 值做不同的处理

3. 引入了客户端 Cookie 机制和安全机制

**http2.0**

1. 多路复用机制（解决 http1.1 中 TCP 拥塞的问题）

2. 设置请求的优先级，可以优先请求 HTML/CSS/JavaScript 等关键资源

3. 服务器推送，访问 html 资源时，提前将相关的 CSS/JavaScript 等资源推送给浏览器

4. 头部压缩，请求头和响应头进行了压缩

**http3.0**

1. QUIC 协议

2. 虽然 UDP 不提供可靠性的传输，但在 QUIC 层实现了**类似 TCP 的流量控制、传输可靠性的功能**

3. 集成了 TLS 加密功能，减少 TSL 握手的时间

4. 实现了快速握手功能，由于 QUIC 是基于 UDP 的，可以用最快的速度来发送和接收数据

5. 实现了 HTTP/2 中的多路复用功能
