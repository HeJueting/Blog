# WebAPI：setTimeout 是如何实现的？

</br>

### 浏览器怎么实现 setTimeout

1. chrome 中有两种消息队列，一种是普通消息队列，一种是延迟消息队列

2. 解析 DOM、垃圾回收、执行 JS 代码...等普通任务会加入普通消息队列中

3. 定时器和 Chromium 内部一些需要延迟执行的任务会加入到**延迟消息队列中**

4. 每执行完一个普通任务，根据发起时间和延迟时间计算出到期的任务，然后依次执行这些到期的任务

</br>
</br>

### 注意事项

1. 如果当前任务执行时间过久，会影响定时器任务的执行

2. 如果定时器被嵌套调用 5 次以上，系统会判断该函数方法被阻塞了，如果定时器的调用时间间隔小于 4 毫秒，那么浏览器会将每次调用的时间间隔设置为 4 毫秒

3. 延时执行时间有最大值

</br>
</br>
